name: Deploy

on:
  workflow_dispatch:
  workflow_run:
    workflows: ["Java CI with Gradle"]
    types: [completed]

jobs:

  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    - name: Deploy to Server
      uses: appleboy/ssh-action@master
      with:
        username: ${{ secrets.SERVER_USERNAME }}
        password: ${{ secrets.SERVER_PASSWORD }}
        host: ${{ secrets.SERVER_ADDRESS }}
        port: ${{ secrets.SERVER_PORT }}
        script: |
          scp ./build/libs/*.jar ${{ secrets.SERVER_USERNAME }}@${{ secrets.SERVER_ADDRESS }}:~/cicd
          # 추가로 필요한 배포 작업 수행
